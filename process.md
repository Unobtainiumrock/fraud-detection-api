# Create the Docker File

# Use an official Python runtime as a parent image
FROM python:3.9-slim

# Set the working directory in the container
WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    build-essential \
    libatlas-base-dev \
    libblas-dev \
    liblapack-dev \
    gfortran \
    git \
    curl \
    && apt-get clean && rm -rf /var/lib/apt/lists/*

# Copy the current directory contents into the container at /app
COPY requirements.txt /app/

# Install any needed packages specified in requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# Copy the rest of your application's code
COPY . /app

# Make port 80 available to the world outside this container
EXPOSE 80

# Define environment variable
ENV NAME World

# Run app.py when the container launches
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "80"]

# Create the Requirements.txt File

fastapi
uvicorn
numpy
pandas
matplotlib
jupyter
scikit-learn
keras
torch
joblib
pydantic

# Docker Compose
version: '3.8'
services:
  app:
    build: .
    ports:
      - "80:80"
    volumes:
      - .:/app
    command: uvicorn main:app --host 0.0.0.0 --port 80

  jupyter:
    image: jupyter/base-notebook
    ports:
      - "8888:8888"
    volumes:
      - .:/home/jovyan/work
    environment:
      - JUPYTER_ENABLE_LAB=yes

# Bulding & Running the Docker Container
docker-compose up

# Accessing Services

- The [FastAPI](https://fastapi.tiangolo.com/) will be available at `http://localhost:8000` and the interactive API documentation generated by [Swagger UI](https://swagger.io/tools/swagger-ui/) be accessed at `htttp://localhost:8000/docs`
- JupyterLab can be accessed at `http://localhost:8888` (retrieve the token from Docker logs).


